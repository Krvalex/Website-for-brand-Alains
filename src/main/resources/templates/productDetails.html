<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Product Details</title>
    <link href="/css/navigation.css" rel="stylesheet">
    <link href="/css/productDetails.css" rel="stylesheet">
</head>
<body>
<div th:replace="~{navigation.html :: navigation}"></div>
<div class="back-button-wrapper">
    <a class="back-button" href="javascript:history.back()">
        <span class="back-arrow">&#8592;</span> –í–ï–†–ù–£–¢–¨–°–Ø
    </a>
</div>
<div class="product-details">
    <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ -->
    <div class="product-images">
        <img alt="Product Front" class="product-image-main" th:src="@{${product.imageFront}}">
        <img alt="Product Back" class="product-image-secondary" th:src="@{${product.imageBack}}">
    </div>

    <!-- –î–µ—Ç–∞–ª–∏ —Ç–æ–≤–∞—Ä–∞ -->
    <div class="product-info-wrapper">
        <div class="product-info">
            <h1 class="product-name" th:text="${product.name}"></h1>
            <div class="price-wrapper">
                <p class="product-price" th:text="${product.price} + ' ‚ÇΩ'"></p>
                <p class="product-price-discounted" th:text="${oldPrice} + ' ‚ÇΩ'"></p>
            </div>
            <pre class="product-description" th:text="${product.description}"></pre>
            <p class="product-note">
                *–ì–æ—Ç–æ–≤–æ–µ –∏–∑–¥–µ–ª–∏–µ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ<br>
                –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –¥–æ 2 —Å–º.<br>
                –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –Ω–∞–Ω–µ—Å–µ–Ω–∏—è –∏ –∏–∑–¥–µ–ª–∏—è –º–æ–≥—É—Ç<br>
                –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç –∑–∞—è–≤–ª–µ–Ω–Ω–æ–≥–æ<br>
                –º–∞–∫–µ—Ç–∞.
            </p>
            <!-- –í—ã–±–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ -->
            <div class="size-selection">
                <div class="size-options">
                    <!-- –ü—Ä–∏–º–µ—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ -->
                    <button class="size-option" data-size="XS" th:classappend="${product.sizes['XS'] == 0} ? 'disabled' : ''" th:data-quantity="${product.sizes['XS']}"
                            th:disabled="${product.sizes['XS'] == 0}"
                            type="button">XS
                    </button>
                    <button class="size-option" data-size="S" th:classappend="${product.sizes['S'] == 0} ? 'disabled' : ''" th:data-quantity="${product.sizes['S']}"
                            th:disabled="${product.sizes['S'] == 0}"
                            type="button">S
                    </button>
                    <button class="size-option" data-size="M" th:classappend="${product.sizes['M'] == 0} ? 'disabled' : ''" th:data-quantity="${product.sizes['M']}"
                            th:disabled="${product.sizes['M'] == 0}"
                            type="button">M
                    </button>
                    <button class="size-option" data-size="L" th:classappend="${product.sizes['L'] == 0} ? 'disabled' : ''" th:data-quantity="${product.sizes['L']}"
                            th:disabled="${product.sizes['L'] == 0}"
                            type="button">L
                    </button>
                    <button class="size-option" data-size="XL" th:classappend="${product.sizes['XL'] == 0} ? 'disabled' : ''" th:data-quantity="${product.sizes['XL']}"
                            th:disabled="${product.sizes['XL'] == 0}"
                            type="button">XL
                    </button>
                    <button class="size-option" data-size="XXL" th:classappend="${product.sizes['XXL'] == 0} ? 'disabled' : ''" th:data-quantity="${product.sizes['XXL']}"
                            th:disabled="${product.sizes['XXL'] == 0}"
                            type="button">XXL
                    </button>
                </div>
                <form class="size-selection-form" method="post"
                      th:action="@{/cart/add/{productId}(productId=${product.Id})}">
                    <input id="selected-size" name="size" required type="hidden">
                    <div class="add-to-cart-wrapper">
                        <button class="add-to-cart-btn" type="submit">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
                        <span class="heart-icon"
                              onclick="toggleFavorite(this); event.preventDefault(); event.stopPropagation();"
                              th:classappend="${isFavoriteProduct} ? 'active' : ''"
                              th:data-product-id="${product.id}">
            <img alt="Favorite Icon"
                 th:src="@{${isFavoriteProduct ? '/images/various/favorites-active.png' : '/images/various/favorites.png'}}">
        </span>
                    </div>
                </form>

            </div>
        </div>
    </div>
</div>
<section class="reviews-section">
    <h2 class="section-title">–û—Ç–∑—ã–≤—ã</h2>

    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—Ç–∑—ã–≤–∞ -->
    <form class="review-form" onsubmit="return submitReview(event)">
        <div class="rating-stars">
            <span class="star" data-rating="1"></span>
            <span class="star" data-rating="2"></span>
            <span class="star" data-rating="3"></span>
            <span class="star" data-rating="4"></span>
            <span class="star" data-rating="5"></span>
        </div>
        <textarea class="review-input" placeholder="–í–∞—à –æ—Ç–∑—ã–≤..." required></textarea>
        <button class="submit-review-btn" type="submit">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
    </form>

    <!-- –°–ø–∏—Å–æ–∫ –æ—Ç–∑—ã–≤–æ–≤ -->
    <div class="reviews-list">
        <!-- –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π –±–ª–æ–∫ –¥–ª—è –ø—É—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è -->
        <div class="no-reviews" th:if="${#lists.isEmpty(reviews)}">
            üòî –ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤. –ë—É–¥—å –ø–µ—Ä–≤—ã–º!
        </div>
        <div class="review-item" th:each="review : ${reviews}">
            <div class="review-header">
                <span class="review-author" th:text="${review.user.email}"></span>
                <div class="review-rating">
                    <span th:each="i : ${#numbers.sequence(1, 5)}">
                        <span th:text="${i <= review.rating} ? '‚òÖ' : '‚òÜ'"></span>
                    </span>
                </div>
            </div>
            <p class="review-text" th:text="${review.text}"></p>
        </div>
    </div>
</section>
<!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ -->
<div class="notification error" id="errorNotification">
    <button class="close-notification" onclick="closeNotification('errorNotification')">&times;</button>
    <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä —Ç–æ–≤–∞—Ä–∞</p>
</div>

<!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ -->
<div class="notification success" id="successNotification">
    <button class="close-notification" onclick="closeNotification('successNotification')">&times;</button>
    <p>–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É</p>
</div>
<script src="/js/navigation.js"></script>
<script src="/js/productDetails.js"></script>
</body>
</html>
